function pitchpeek(elementId,optionalArguments){this.options={initTour:true,renderMode:"webgl",initialPano:"dwFEQYodwY0AAAQXL2YgRA",disableDefaultUI:false,addressControl:false,zoomControl:false,clickToGo:false,linksControl:true,panControl:false,enableCloseButton:false,visible:true,xml:null,rotatingStart:false,rotatingStopOnHover:true,rotatingFramerate:33,rotatingSpeed:0.1,contentBefore:'<div id="content">',contentAfter:"</div>",menuFirstId:0,menuPosition:"LEFT_TOP",menuButtonBackgroundColor:"#fff",menuButtonBorder:"2px solid #fff",menuButtonBorderRadius:"3px",menuButtonBoxShadow:"0 2px 6px rgba(0,0,0,.3)",menuButtonCursor:"pointer",menuButtonMargin:"3px",menuButtonMinWidth:"100px",menuButtonOpacity:0.9,menuButtonTextAlign:"center",menuButtonTitlePrepend:"Click to go to ",menuButtonTitleAppend:".",menuTextColor:"rgb(25,25,25)",menuTextFontFamily:"Roboto,Arial,sans-serif",menuTextFontSize:"16px",menuTextLineHeight:"38px",menuTextPaddingLeft:"5px",menuTextPaddingRight:"5px",infowindowMaxWidth:null,hotspotDraggable:false,hotspotStrokeColor:"#000",hotspotFillColor:"#0266C8",hotspotOpacity:0.9,hotspotRotation:0,hotspotScale:2,hotspotAnchorX:0,hotspotAnchorY:0,hotspotSvgIcon:"M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M14.757,8h2.42v2.574h-2.42V8z M18.762,23.622H16.1c-1.034,0-1.475-0.44-1.475-1.496v-6.865c0-0.33-0.176-0.484-0.484-0.484h-0.88V12.4h2.662c1.035,0,1.474,0.462,1.474,1.496v6.887c0,0.309,0.176,0.484,0.484,0.484h0.88V23.622z"};this.element=document.getElementById(elementId);if(typeof optionalArguments!=="undefined"){for(var key in this.options){if(optionalArguments.hasOwnProperty(key)){this.options[key]=optionalArguments[key]}}}function objectify(arr){var obj={};for(var i=0;i<arr.length;i++){obj[arr[i]]=""}return obj}function showMarkers(panorama,hotspots){for(var i in hotspots){if(panorama.getPano() in objectify(hotspots[i].show)){hotspots[i].marker.setMap(panorama)}else{hotspots[i].marker.setMap(null)}}}function addViews(panorama,options,views,hotspots){for(var panoid in views){if(options.menuFirstId==0){panorama.setPano(panoid);panorama.setPov(({heading:views[panoid].heading,pitch:views[panoid].pitch,zoom:views[panoid].zoom}))}var centerControlDiv=document.createElement("div");var centerControl=new createMenuItem(centerControlDiv,panorama,options,views[panoid],hotspots);centerControlDiv.index=options.menuFirstId++;panorama.controls[eval("google.maps.ControlPosition."+options.menuPosition)].push(centerControlDiv)}}function addHotspots(panorama,options,hotspots){for(var i in hotspots){var hotspotIcon={path:options.hotspotSvgIcon,strokeColor:options.hotspotStrokeColor,fillColor:options.hotspotFillColor,fillOpacity:options.hotspotOpacity,rotation:options.hotspotRotation,anchor:new google.maps.Point(options.hotspotAnchorX,options.hotspotAnchorY),scale:options.hotspotScale};var content=options.contentBefore+hotspots[i].content+options.contentAfter;var infowindow=new google.maps.InfoWindow({content:content,maxWidth:options.infowindowMaxWidth});var hotspot=new google.maps.LatLng(hotspots[i].latitude,hotspots[i].longitude);var marker=new google.maps.Marker({position:hotspot,map:panorama,icon:hotspotIcon,draggable:options.hotspotDraggable,title:hotspots[i].title});hotspots[i]["marker"]=marker;google.maps.event.addListener(marker,"click",(function(marker,content,infowindow){return function(){infowindow.setContent(content);infowindow.open(panorama,marker)}})(marker,content,infowindow))}}function createMenuItem(controlDiv,panorama,options,view,hotspots){var controlUI=document.createElement("div");controlUI.style.backgroundColor=options.menuButtonBackgroundColor;controlUI.style.border=options.menuButtonBorder;controlUI.style.borderRadius=options.menuButtonBorderRadius;controlUI.style.boxShadow=options.menuButtonBoxShadow;controlUI.style.cursor=options.menuButtonCursor;controlUI.style.margin=options.menuButtonMargin;controlUI.style.minWidth=options.menuButtonMinWidth;controlUI.style.opacity=options.menuButtonOpacity;controlUI.style.textAlign=options.menuButtonTextAlign;controlUI.title=options.menuButtonTitlePrepend+view.title+options.menuButtonTitleAppend;controlDiv.appendChild(controlUI);var controlText=document.createElement("div");controlText.style.color=options.menuTextColor;controlText.style.fontFamily=options.menuTextFontFamily;controlText.style.fontSize=options.menuTextFontSize;controlText.style.lineHeight=options.menuTextLineHeight;controlText.style.paddingLeft=options.menuTextPaddingLeft;controlText.style.paddingRight=options.menuTextPaddingRight;controlText.innerHTML=view.title;controlUI.appendChild(controlText);google.maps.event.addDomListener(controlUI,"click",function(){panorama.setPano(view.panoid);panorama.setPov(({heading:view.heading,pitch:view.pitch,zoom:view.zoom}))})}function stopRotation(timer){return function(){clearInterval(timer)}}function startRotation(panorama,rotateTick){var currentPov=panorama.getPov();panorama.setPov({heading:currentPov.heading+rotateTick,pitch:currentPov.pitch,zoom:currentPov.zoom})}this.setView=function(view){var panoid=(view.panoid===undefined)?this.panorama.getPano():view.panoid;var heading=(view.heading===undefined)?this.panorama.getPov().heading:view.heading;var pitch=(view.pitch===undefined)?this.panorama.getPov().pitch:view.pitch;var zoom=(view.zoom===undefined)?this.panorama.getPov().zoom:view.zoom;this.panorama.setPano(panoid);this.panorama.setPov(({heading:heading,pitch:pitch,zoom:zoom}))};this.loadXMLDoc=function(options,panorama,tourHotspots){var xmlhttp;var views,hotspots;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){views=xmlhttp.responseXML.documentElement.getElementsByTagName("VIEW");var tourViews={};for(var i=0;i<views.length;i++){var panoid=views[i].getElementsByTagName("PANOID")[0].firstChild.nodeValue;var title=views[i].getElementsByTagName("TITLE")[0].firstChild.nodeValue;var heading=parseFloat(views[i].getElementsByTagName("HEADING")[0].firstChild.nodeValue);var pitch=parseFloat(views[i].getElementsByTagName("PITCH")[0].firstChild.nodeValue);var zoom=parseFloat(views[i].getElementsByTagName("ZOOM")[0].firstChild.nodeValue);tourViews[panoid]={panoid:panoid,title:title,heading:heading,pitch:pitch,zoom:zoom}}hotspots=xmlhttp.responseXML.documentElement.getElementsByTagName("HOTSPOT");var tourHotspots={};for(i=0;i<hotspots.length;i++){var title=hotspots[i].getElementsByTagName("TITLE")[0].firstChild.nodeValue;var content=hotspots[i].getElementsByTagName("CONTENT")[0].firstChild.nodeValue;var latitude=parseFloat(hotspots[i].getElementsByTagName("LATITUDE")[0].firstChild.nodeValue);var longitude=parseFloat(hotspots[i].getElementsByTagName("LONGITUDE")[0].firstChild.nodeValue);var pano=hotspots[i].getElementsByTagName("PANO");var show=[];for(var j=0;j<pano.length;j++){show.push(pano[j].firstChild.nodeValue)}tourHotspots[i]={title:title,content:content,latitude:latitude,longitude:longitude,show:show}}addViews(panorama,options,tourViews,tourHotspots);addHotspots(panorama,options,tourHotspots);showMarkers(panorama,tourHotspots);google.maps.event.addListener(panorama,"pano_changed",function(){showMarkers(panorama,tourHotspots)})}};xmlhttp.open("GET",options.xml,true);xmlhttp.send()};this.tour=function(){var panoramaOptions={pano:this.options.initialPano,mode:this.options.renderMode,disableDefaultUI:this.options.disableDefaultUI,addressControl:this.options.addressControl,zoomControl:this.options.zoomControl,clickToGo:this.options.clickToGo,linksControl:this.options.linksControl,panControl:this.options.panControl,enableCloseButton:this.options.enableCloseButton,visible:this.options.visible};this.panorama=new google.maps.StreetViewPanorama(this.element,panoramaOptions);if(this.options.xml){this.loadXMLDoc(this.options,this.panorama,this.tourHotspots)}if(this.options.rotatingStart){var timer=setInterval(startRotation,this.options.rotatingFramerate,this.panorama,this.options.rotatingSpeed);if(this.options.rotatingStopOnHover){this.element.onmouseover=stopRotation(timer)}}};if(this.options.initTour){this.tour()}};