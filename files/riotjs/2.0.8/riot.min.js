/* Riot v2.0.8, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(){var e={version:"v2.0.8",settings:{}};"use strict";e.observable=function(e){e=e||{};var n={};e.on=function(t,i){if(typeof i=="function"){t.replace(/\S+/g,function(e,t){(n[e]=n[e]||[]).push(i);i.typed=t>0})}return e};e.off=function(t,i){if(t=="*")n={};else if(i){var r=n[t];for(var o=0,u;u=r&&r[o];++o){if(u==i){r.splice(o,1);o--}}}else{t.replace(/\S+/g,function(e){n[e]=[]})}return e};e.one=function(n,t){if(t)t.one=1;return e.on(n,t)};e.trigger=function(t){var i=[].slice.call(arguments,1),r=n[t]||[];for(var o=0,u;u=r[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[t].concat(i):i);if(u.one){r.splice(o,1);o--}else if(r[o]!==u){o--}u.busy=0}}return e};return e};(function(e,n){if(!this.top)return;var t=location,i=e.observable(),r=u(),o=window;function u(){return t.hash.slice(1)}function f(e){return e.split("/")}function a(e){if(e.type)e=u();if(e!=r){i.trigger.apply(null,["H"].concat(f(e)));r=e}}var c=e.route=function(e){if(e[0]){t.hash=e;a(e)}else{i.on("H",e)}};c.exec=function(e){e.apply(null,f(u()))};c.parser=function(e){f=e};o.addEventListener?o.addEventListener(n,a,false):o.attachEvent("on"+n,a)})(e,"hashchange");var n=function(){var n={},t,i,r=/("|').+?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_]\w*)/gi;return function(r,u){var f=e.settings.brackets||"{ }";if(f!=t){t=f.split(" ");i=a(/({[\s\S]*?})/)}return u?r&&(n[r]=n[r]||o(r))(u):i.test(r)};function o(e,n){n=(e||t.join("")).replace(a(/\\{/),"￰").replace(a(/\\}/),"￱").split(i);return new Function("d","return "+(!n[0]&&!n[2]&&!n[3]?u(n[1]):"["+n.map(function(e,n){return n%2?u(e,1):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,t[0]).replace(/\uFFF1/g,t[1]))}function u(e,n){e=e.replace(/\n/g," ").replace(a(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w-"']+ *:/.test(e)?"["+e.replace(/\W*([\w-]+)\W*:([^,]+)/g,function(e,t,i){return i.replace(/\w[^,|& ]*/g,function(e){return f(e,n)})+'?"'+t+'":"",'})+'].join(" ")':f(e,n)}function f(e,n){return"(function(v){try{v="+(e.replace(r,function(e,n,t){return t?"(d."+t+"===undefined?window."+t+":d."+t+")":e})||"x")+"}finally{return "+(n?'!v&&v!==0?"":v':"v")+"}}).call(d)"}function a(e){return RegExp(e.source.split("{").join("\\"+t[0]).split("}").join("\\"+t[1]),e.global?"g":"")}}();function t(e){var n={val:e},t=e.split(/\s+in\s+/);if(t[1]){n.val="{ "+t[1];t=t[0].slice(1).trim().split(/,\s*/);n.key=t[0];n.pos=t[1]}return n}function i(e,i,r){s(e,"each");var o=e.outerHTML,f=e.previousSibling,a=e.parentNode,c=[],l=[],p;r=t(r);i.one("update",function(){a.removeChild(e)}).one("mount",function(){if(!m(a))a=i.root}).on("update",function(){var e=n(r.val,i);if(!e)return;if(!Array.isArray(e)){var t=JSON.stringify(e);if(t==p)return;p=t;l.map(function(e){e.unmount()});l=c=[];e=Object.keys(e).map(function(n,t){var i={};i[r.key]=n;i[r.pos]=e[n];return i})}h(c,e).map(function(e){var n=c.indexOf(e),t=l[n];if(t){t.unmount();c.splice(n,1);l.splice(n,1)}});var s=a.childNodes,d=Array.prototype.indexOf.call(s,f);h(e,c).map(function(n,t){var f=e.indexOf(n);if(!p&&r.key){var c={};c[r.key]=n;c[r.pos]=f;n=c}var v=new u({tmpl:o},{before:s[d+1+f],parent:i,root:a,loop:true,item:n});l.splice(f,0,v)});c=e.slice()})}function r(e,n,t){v(e,function(e){if(e.nodeType!=1)return;l(e.attributes,function(t){if(/^(name|id)$/.test(t.name))n[t.value]=e})})}function o(e,t,r){function o(e,t,i){if(n(t)||i){var o={dom:e,expr:t};r.push(p(o,i||{}))}}v(e,function(e){var n=e.nodeType;if(n==3&&e.parentNode.tagName!="STYLE")o(e,e.nodeValue);if(n!=1)return;var r=e.getAttribute("each");if(r){i(e,t,r);return false}var f=b[e.tagName.toLowerCase()];if(f){f=new u(f,{root:e,parent:t});return false}l(e.attributes,function(n){var t=n.name,i=n.value;var r=t.split("__")[1];o(e,i,{attr:r||t,bool:r});if(r){s(e,t);return false}})})}function u(t,i){var u=e.observable(this),f=[],a={},v=i.parent,h=i.loop,g=i.root,b=i.opts,y=i.item;if(!h&&g.riot)return;g.riot=1;b=b||{};p(this,{parent:v,root:g,opts:b,children:[]});p(this,y);l(g.attributes,function(e){var n=e.name,t=e.value;a[n]=t;if(t.indexOf("{")>=0){s(g,n);return false}});function w(){Object.keys(a).map(function(e){b[e]=n(a[e],v||u)})}w();v&&v.children.push(this);var x=d(t.tmpl),C;r(x,this);this.update=function(e,n){p(u,e);p(u,y);u.trigger("update");w();c(f,u,y);u.trigger("updated")};this.unmount=function(){if(h){g.removeChild(C)}else{var e=g.parentNode;e&&e.removeChild(g)}if(v){var n=v.children;n.splice(n.indexOf(u),1)}u.trigger("unmount");v&&v.off("update",u.update);mounted=false};function j(){while(x.firstChild){if(h){C=x.firstChild;g.insertBefore(x.firstChild,i.before||null)}else{g.appendChild(x.firstChild)}}if(!m(g))u.root=g=v.root;u.trigger("mount");v&&v.on("update",u.update).one("unmount",u.unmount)}if(t.fn)t.fn.call(this,b);o(x,this,f);this.update();j()}function f(e,n,t,i,r){t[e]=function(e){e=e||window.event;e.which=e.which||e.charCode||e.keyCode;e.target=e.target||e.srcElement;e.currentTarget=t;e.item=r;if(n.call(i,e)!==true){e.preventDefault&&e.preventDefault();e.returnValue=false}i.update()}}function a(e,n,t){if(e){e.insertBefore(t,n);e.removeChild(n)}}function c(e,t,i){l(e,function(e){var r=e.dom,o=e.attr,u=n(e.expr,t);if(u==null)u="";if(e.value===u)return;e.value=u;if(!o)return r.nodeValue=u;if(!u&&e.bool||/obj|func/.test(typeof u))s(r,o);if(typeof u=="function"){f(o,u,r,t,i)}else if(o=="if"){s(r,o);var c=e.stub;if(u){c&&a(c.parentNode,c,r)}else{c=e.stub=c||document.createTextNode("");a(r.parentNode,r,c)}}else if(/^(show|hide)$/.test(o)){s(r,o);if(o=="hide")u=!u;r.style.display=u?"":"none"}else{if(e.bool){r[o]=u;if(!u)return;u=o}r.setAttribute(o,u)}})}function l(e,n){for(var t=0;t<(e||[]).length;t++){if(n(e[t],t)===false)t--}}function s(e,n){e.removeAttribute(n)}function p(e,n){n&&Object.keys(n).map(function(t){e[t]=n[t]});return e}function d(e){var n=e.trim().slice(1,3).toLowerCase(),t=/td|th/.test(n)?"tr":n=="tr"?"tbody":"div";el=document.createElement(t);el.stub=true;el.innerHTML=e;return el}function v(e,n){e=n(e)===false?e.nextSibling:e.firstChild;while(e){v(e,n);e=e.nextSibling}}function h(e,n){return e.filter(function(e){return n.indexOf(e)<0})}function m(e){var n=e.parentNode,t=window.HTMLDocument;return n&&!(t&&n instanceof t)}var g=[],b={};e.tag=function(e,n,t){b[e]={name:e,tmpl:n,fn:t}};var y=e.mountTo=function(e,n,t){var i=b[n],r;if(i)r=new u(i,{root:e,opts:t});if(r){g.push(r);return r.on("unmount",function(){g.splice(g.indexOf(r),1)})}};e.mount=function(e,n){if(e=="*")e=Object.keys(b).join(", ");var t=[];l(document.querySelectorAll(e),function(e){var i=e.tagName.toLowerCase(),r=y(e,i,n);if(r)t.push(r)});return t};e.update=function(){g.map(function(e){e.update()});return g};if(typeof exports==="object")module.exports=e;else if(typeof define==="function"&&define.amd)define(function(){return e});else this.riot=e})();
