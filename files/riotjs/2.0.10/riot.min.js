/* Riot v2.0.10, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(){var e={version:"v2.0.10",settings:{}};"use strict";e.observable=function(e){e=e||{};var t={},n=0;e.on=function(i,r){if(typeof r=="function"){r._id=n++;i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(r);r.typed=n>0})}return e};e.off=function(n,i){if(n=="*")t={};else if(i){var r=t[n];for(var o=0,u;u=r&&r[o];++o){if(u._id==i._id){r.splice(o,1);o--}}}else{n.replace(/\S+/g,function(e){t[e]=[]})}return e};e.one=function(t,n){if(n)n.one=1;return e.on(t,n)};e.trigger=function(n){var i=[].slice.call(arguments,1),r=t[n]||[];for(var o=0,u;u=r[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[n].concat(i):i);if(u.one){r.splice(o,1);o--}else if(r[o]!==u){o--}u.busy=0}}return e};return e};(function(e,t){if(!this.top)return;var n=location,i=e.observable(),r=window,o;function u(){return n.hash.slice(1)}function f(e){return e.split("/")}function a(e){if(e.type)e=u();if(e!=o){i.trigger.apply(null,["H"].concat(f(e)));o=e}}var c=e.route=function(e){if(e[0]){n.hash=e;a(e)}else{i.on("H",e)}};c.exec=function(e){e.apply(null,f(u()))};c.parser=function(e){f=e};r.addEventListener?r.addEventListener(t,a,false):r.attachEvent("on"+t,a)})(e,"hashchange");var t=function(t,n,i){return function(r){n=e.settings.brackets||t;if(i!=n)i=n.split(" ");return r&&r.test?n==t?r:RegExp(r.source.replace(/\{/g,i[0].replace(/(?=.)/g,"\\")).replace(/\}/g,i[1].replace(/(?=.)/g,"\\")),r.global?"g":""):i[r]}}("{ }");var n=function(){var e={},n=/({[\s\S]*?})/,i=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_]\w*)/gi;return function(t,n){return t&&(e[t]=e[t]||r(t))(n)};function r(e,i){i=(e||t(0)+t(1)).replace(t(/\\{/),"￰").replace(t(/\\}/),"￱").split(t(n));return new Function("d","return "+(!i[0]&&!i[2]&&!i[3]?o(i[1]):"["+i.map(function(e,t){return t%2?o(e,1):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,t(0)).replace(/\uFFF1/g,t(1)))}function o(e,n){e=e.replace(/\n/g," ").replace(t(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w- "']+ *:/.test(e)?"["+e.replace(/\W*([\w- ]+)\W*:([^,]+)/g,function(e,t,n){return n.replace(/[^&|=!><]+/g,u)+'?"'+t.trim()+'":"",'})+'].join(" ")':u(e,n)}function u(e,t){e=e.trim();return!e?"":"(function(v){try{v="+(e.replace(i,function(e,t,n){return n?"(d."+n+"===undefined?window."+n+":d."+n+")":e})||"x")+"}finally{return "+(t?'!v&&v!==0?"":v':"v")+"}}).call(d)"}}();function i(e){var n={val:e},i=e.split(/\s+in\s+/);if(i[1]){n.val=t(0)+i[1];i=i[0].slice(t(0).length).trim().split(/,\s*/);n.key=i[0];n.pos=i[1]}return n}function r(e,t,n){var i={};i[e.key]=t;if(e.pos)i[e.pos]=n;return i}function o(e,t,o){d(e,"each");var u=e.outerHTML,f=e.previousSibling,c=e.parentNode,l=[],s=[],v;o=i(o);function m(e,t,n){l.splice(e,0,t);s.splice(e,0,n)}t.one("update",function(){c.removeChild(e)}).one("mount",function(){if(c.stub)c=t.root}).on("update",function(){var e=n(o.val,t);if(!e)return;if(!Array.isArray(e)){var i=JSON.stringify(e);if(i==v)return;v=i;p(s,function(e){e.unmount()});l=[];s=[];e=Object.keys(e).map(function(t){return r(o,t,e[t])})}p(g(l,e),function(e){var t=l.indexOf(e),n=s[t];if(n){n.unmount();l.splice(t,1);s.splice(t,1)}});var d=c.childNodes,h=[].indexOf.call(d,f);p(e,function(n,i){var f=e.indexOf(n,i),p=l.indexOf(n,i);f<0&&(f=e.lastIndexOf(n,i));p<0&&(p=l.lastIndexOf(n,i));if(p<0){if(!v&&o.key)n=r(o,n,f);var g=new a({tmpl:u},{before:d[h+1+f],parent:t,root:c,loop:true,item:n});return m(f,n,g)}if(o.pos&&s[p][o.pos]!=f){s[p].one("update",function(e){e[o.pos]=f});s[p].update()}if(f!=p){c.insertBefore(d[h+p+1],d[h+f+1]);return m(f,l.splice(p,1)[0],s.splice(p,1)[0])}});l=e.slice()})}function u(e,t,n){h(e,function(e){if(e.nodeType!=1)return;p(e.attributes,function(n){if(/^(name|id)$/.test(n.name))t[n.value]=e})})}function f(e,n,i){function r(e,n,r){if(n.indexOf(t(0))>=0){var o={dom:e,expr:n};i.push(v(o,r))}}h(e,function(e){var t=e.nodeType;if(t==3&&e.parentNode.tagName!="STYLE")r(e,e.nodeValue);if(t!=1)return;var i=e.getAttribute("each");if(i){o(e,n,i);return false}p(e.attributes,function(t){var n=t.name,i=t.value;var o=n.split("__")[1];r(e,i,{attr:o||n,bool:o});if(o){d(e,n);return false}});var u=w[e.tagName.toLowerCase()];if(u)u=new a(u,{root:e,parent:n})})}function a(i,r){var o=e.observable(this),a=[],c={},l=r.parent,h=r.loop,g=r.root,y=b(r.opts),w=r.item;if(!h&&g.riot)return;g.riot=1;y=y||{};v(this,{parent:l,root:g,opts:y});v(this,w);p(g.attributes,function(e){var n=e.name,i=e.value;c[n]=i;if(i.indexOf(t(0))>=0){d(g,n);return false}});function x(){p(Object.keys(c),function(e){y[e]=n(c[e],l||o)})}x();var O=m(i.tmpl),C;u(O,this);this.update=function(e,t){v(o,e);v(o,w);o.trigger("update",w);x();s(a,o,w);o.trigger("updated")};this.unmount=function(){var e=h?C:g,t=e.parentNode;if(t){t.removeChild(e);o.trigger("unmount");l&&l.off("update",o.update).off("unmount",o.unmount);o.off("*")}};function N(){if(h){C=O.firstChild;g.insertBefore(C,r.before||null)}else{while(O.firstChild)g.appendChild(O.firstChild)}if(g.stub)o.root=g=l.root;o.trigger("mount");l&&l.on("update",o.update).one("unmount",o.unmount)}if(i.fn)i.fn.call(this,y);f(O,this,a);this.update();N()}function c(e,t,n,i,r){n[e]=function(e){e=e||window.event;e.which=e.which||e.charCode||e.keyCode;e.target=e.target||e.srcElement;e.currentTarget=n;e.item=r;if(t.call(i,e)!==true){e.preventDefault&&e.preventDefault();e.returnValue=false}var o=r?i.parent:i;o.update()}}function l(e,t,n){if(e){e.insertBefore(n,t);e.removeChild(t)}}function s(e,t,i){p(e,function(e){var r=e.dom,o=e.attr,u=n(e.expr,t);if(u==null)u="";if(e.value===u)return;e.value=u;if(!o)return r.nodeValue=u;d(r,o);if(typeof u=="function"){c(o,u,r,t,i)}else if(o=="if"){var f=e.stub;if(u){f&&l(f.parentNode,f,r)}else{f=e.stub=f||document.createTextNode("");l(r.parentNode,r,f)}}else if(/^(show|hide)$/.test(o)){if(o=="hide")u=!u;r.style.display=u?"":"none"}else if(o=="value"){r.value=u}else if(o=="riot-src"){u?r.setAttribute("src",u):d(r,"src")}else{if(e.bool){r[o]=u;if(!u)return;u=o}r.setAttribute(o,u)}})}function p(e,t){for(var n=0,i=(e||[]).length,r;n<i;n++){r=e[n];if(r!=null&&t(r,n)===false)n--}}function d(e,t){e.removeAttribute(t)}function v(e,t){t&&p(Object.keys(t),function(n){e[n]=t[n]});return e}function m(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":t=="tr"?"tbody":"div",i=document.createElement(n);i.stub=true;i.innerHTML=e;return i}function h(e,t){e=t(e)===false?e.nextSibling:e.firstChild;while(e){h(e,t);e=e.nextSibling}}function g(e,t){return e.filter(function(e){return t.indexOf(e)<0})}function b(e){function t(){}t.prototype=e;return new t}var y=[],w={};function x(e){var t=document.createElement("style");t.innerHTML=e;document.head.appendChild(t)}e.tag=function(e,t,n,i){if(typeof n=="function")i=n;else if(n)x(n);w[e]={name:e,tmpl:t,fn:i}};var O=e.mountTo=function(e,t,n){var i=w[t],r;if(i&&e){e.riot=0;r=new a(i,{root:e,opts:n})}if(r){y.push(r);return r.on("unmount",function(){y.splice(y.indexOf(r),1)})}};e.mount=function(e,t){if(e=="*")e=Object.keys(w).join(", ");var n=[];p(document.querySelectorAll(e),function(e){if(e.riot)return;var i=e.tagName.toLowerCase(),r=O(e,i,t);if(r)n.push(r)});return n};e.update=function(){p(y,function(e){e.update()});return y};e.util={brackets:t,tmpl:n};if(typeof exports==="object")module.exports=e;else if(typeof define==="function"&&define.amd)define(function(){return e});else this.riot=e})();
