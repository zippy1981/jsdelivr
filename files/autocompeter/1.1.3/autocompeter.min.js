!function(e,t){"use strict";function n(e,n){var a=t.createElement(e);for(var l in n)a[l]=n[l];return a}function a(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent(t,n)}function l(){var e,t,n,a,l,r,u,o=[].slice;for(a=arguments[0],n=2<=arguments.length?o.call(arguments,1):[],r=0,u=n.length;u>r;r++){t=n[r];for(e in t)l=t[e],a[e]=l}return a}function r(r,u){function o(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function s(e){var t=R.map(o),n=new RegExp("\\b("+t.join("|")+")","gi");return e.replace(n,"<b>$1</b>")}function i(e){"P"===e.target.tagName&&x!==+e.target.dataset.i&&(x=+e.target.dataset.i,c())}function p(e,t){for(var n=[],a=t.map(o),l=new RegExp("\\b("+a.join("|")+")","gi"),r=0,u=e.length;u>r;r++)l.test(e[r][1])&&n.push(e[r]);return n}function c(e){e=e||!1;var a,l;if(null!==k){if(e&&(k=p(k,R)),k.length){N.style.display="block";var u=N.getElementsByTagName("p");for(a=u.length-1;a>=0;a--)u[a].remove()}else N.style.display="none";w=[];var i,c,d=null,v=[];k.length||(C.value=r.value);var f=R.map(o),g=new RegExp("\\b("+f.join("|")+")(\\w+)\\b","gi"),m=t.createDocumentFragment();for(a=0,l=k.length;l>a;a++){for(var h,y;null!==(h=g.exec(k[a][1]));)y=new RegExp("\\b"+o(h[0])+"\\b","gi"),d=h[h.length-1],void 0===d||y.test(r.value)||x===a&&v.push(d);i=n("p"),a===x&&i.classList.add("selected"),i.dataset.i=a,c=n("a",{innerHTML:s(k[a][1]),href:k[a][0]}),i.appendChild(c),m.appendChild(i),w.push(i)}N.appendChild(m),v.length&&" "!==r.value.charAt(r.value.length-1)?(d=v[x%v.length],C.value=r.value+d):C.value=r.value}}function d(e){var t=e.parentNode;if("FORM"===t.nodeName)return t;if(null===t)throw"too deep. no parent form node to be found";return d(t)}function v(t){var n,a;if("tab"===t)C.value!==r.value&&(r.value=C.value+" "),r.value!==C.value&&m();else if("down"===t||"up"===t){for("down"===t?x=Math.min(w.length-1,++x):"up"===t&&(x=Math.max(0,--x)),n=0,a=w.length;a>n;n++)n===x?w[n].classList.add("selected"):w[n].classList.remove("selected");c()}else if("enter"===t){if(!w.length)return d(r).submit(),!0;var l=w[x],u=l.getElementsByTagName("a")[0];r.value=C.value=u.textContent,N.style.display="none",e.location=u.href}else"esc"===t&&(N.style.display="none");return!1}function f(e){var t={13:"enter",9:"tab",38:"up",40:"down",27:"esc"};return t[e.keyCode]?(e.preventDefault(),v(t[e.keyCode])):!1}function g(){N.style.display="none"}function m(){if(!r.value.trim())return C.value="",void(N.style.display="none");if(C.value.length&&(-1===C.value.indexOf(r.value.trim())&&(C.value=r.value),"block"===N.style.display&&(R=r.value.trim().split(/\s+/),c(!0))),x=0,X[r.value.trim()]){var t=X[r.value.trim()];R=t.terms,k=t.results,c()}else{if(M&&M.abort(),e.XMLHttpRequest)M=new e.XMLHttpRequest;else{if(!e.ActiveXObject)return;M=new e.ActiveXObject("Microsoft.XMLHTTP")}M.onreadystatechange=function(){if(4===M.readyState)if(200===M.status){if(T===r.value){var e=JSON.parse(M.responseText);X[r.value.trim()]=e,R=e.terms,k=e.results,c()}}else 0!==M.status&&(console.warn(M.status,M.responseText),g())},M.open("GET",u.url+encodeURIComponent(r.value.trim()),!0),T=r.value,M.send()}}function h(e){C.value=r.value,setTimeout(function(){N.style.display="none"},200),e.preventDefault()}function y(){r.value.length&&w.length&&(N.style.display="block")}if(u=l({url:"https://autocompeter.com/v1",domain:location.host,groups:null,ping:!1},u||{}),u.url+=u.url.indexOf("?")>-1?"&":"?",u.number&&(u.url+="n="+u.number+"&"),u.groups&&(Array.isArray(u.groups)&&(u.groups=u.groups.join(",")),u.url+="g="+encodeURIComponent(u.groups)+"&"),u.url+="d="+u.domain+"&q=",u.ping&&e.XMLHttpRequest){var b=new e.XMLHttpRequest;b.open("GET",u.url.split("?")[0]+"/ping"),b.send()}var w=[],x=0;r.spellcheck=!1,r.autocomplete="off";var E=n("span",{className:"_ac-wrap"}),C=n("input",{tabindex:-1,spellcheck:!1,autocomplete:"off",readonly:"readonly",type:r.type||"text",className:r.className+" _ac-hint"});r.classList.add("_ac-foreground"),E.appendChild(C);var L=r.cloneNode(!0);E.appendChild(L);var N=n("div",{className:"_ac-results"});a(N,"mouseover",i),E.appendChild(N),r.parentElement.insertBefore(E,r),r.parentNode.removeChild(r),r=L;var R,M,T,k=null,X={};a(r,"input",m),a(r,"keydown",f),a(r,"blur",h),a(r,"focus",y)}e.Autocompeter=r}(window,document);